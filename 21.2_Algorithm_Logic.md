# 21.2 Handpan Recommendation Algorithm Logic

## 1. 개요 (Overview)
이 문서는 '나에게 맞는 핸드팬 찾기' 서비스의 핵심인 **벡터 기반 추천 알고리즘(Vector-based Recommendation Engine)**의 논리를 설명합니다. 사용자의 취향을 3차원 좌표(Vector)로 변환하고, 데이터베이스에 있는 스케일들과의 거리를 계산하여 가장 적합한 모델을 추천합니다.

## 2. 벡터 공간 정의 (Vector Space Definition)
모든 핸드팬 스케일은 다음 3가지 축을 기준으로 정량화됩니다.

### X축: 조성 (Mood) - `minorMajor`
스케일이 주는 전체적인 감정적 분위기를 결정합니다.
- **Range:** `-1.0` (Dark/Minor) ~ `+1.0` (Bright/Major)
- **의미:**
    - `-1.0 ~ -0.5`: 깊은 슬픔, 우울함, 진지함 (예: Kurd, Aeolian)
    - `-0.4 ~ +0.4`: 중립적, 신비로움, 몽환적 (예: Equinox, La Sirena)
    - `+0.5 ~ +1.0`: 밝음, 희망, 명랑함 (예: Sabye, Ashakiran)

### Y축: 음향 질감 (Tone) - `pureSpicy`
소리의 담백함과 화려함(긴장감)의 정도를 나타냅니다.
- **Range:** `0.0` (Pure) ~ `1.0` (Spicy)
- **의미:**
    - `0.0 ~ 0.3`: 협화음 위주, 편안함, 명상적 (예: Celtic Minor, Oxalis)
    - `0.4 ~ 0.6`: 약간의 텐션, 감성적인 스토리텔링 (예: Pygmy, Equinox)
    - `0.7 ~ 1.0`: 불협화음(반음) 포함, 이국적, 강렬한 자극 (예: Hijaz, Saladin)

### Z축: 대중성 (Popularity) - `rarePopular`
시장에서의 희소성과 대중적인 인기를 나타냅니다.
- **Range:** `0.0` (Rare) ~ `1.0` (Popular)
- **의미:**
    - `0.0 ~ 0.3`: 희귀함, 매니아 취향, 독특한 개성
    - `0.4 ~ 0.7`: 적당한 인지도, 입문~중급자 추천
    - `0.8 ~ 1.0`: 글로벌 베스트셀러, 호불호 없는 대중성

## 3. 추천 알고리즘 (Recommendation Logic)

### 거리 계산 (Distance Calculation)
사용자가 선택한 값(Target Vector)과 각 스케일의 값(Scale Vector) 사이의 **유클리드 거리(Euclidean Distance)**를 계산합니다.

$$
Distance = \sqrt{(x_2 - x_1)^2 + (y_2 - y_1)^2 + (z_2 - z_1)^2}
$$

거리가 가까울수록 사용자의 취향에 근접한 스케일입니다.

### 가중치 (Weighting) - *Future Plan*
현재는 모든 축을 동일하게 취급하지만, 향후 사용자가 "나는 분위기가 제일 중요해"라고 할 경우 해당 축에 가중치를 곱하여 계산할 수 있습니다.

## 4. 데이터 구조 (Data Structure)
시스템은 `HandpanScale` 인터페이스를 통해 데이터를 관리합니다. (참조: `data/types.ts`)

```typescript
interface HandpanScale {
    id: string;
    name: string;
    notes: {
        ding: string;     // 중심음 (Bass)
        top: string[];    // 상단 노트 (Melody)
        bottom: string[]; // 하단 노트 (Deep Bass)
    };
    vector: {
        minorMajor: number;
        pureSpicy: number;
        rarePopular: number;
    };
    // ... metadata (tags, urls)
}
```

## 5. 결론
이 알고리즘은 주관적인 "느낌"을 객관적인 "수치"로 변환하여, 사용자가 막연하게 상상하는 소리를 구체적인 제품으로 연결해주는 **"Sonic Navigation"** 시스템입니다.
